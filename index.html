<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡å¹»å³¶å¶¼æ¢éšª</title>
    <style>
        /* === èªè¨€åˆ‡æ›æŒ‰éˆ•æ¨£å¼ (å³ä¸Šè§’) === */
        #lang-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 50px;
            height: auto;
            z-index: 100;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #lang-switch img {
            width: 100%;
            height: auto;
            display: block;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.5));
        }

        #lang-switch:active {
            transform: scale(0.9);
        }
        /* CSS æ¨£å¼å€ - æ§åˆ¶å¤–è§€ */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            font-family: "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
            overflow: hidden; /* é˜²æ­¢æ²å‹• */
        }
/* === 0. å…¬å¸ç‰‡é ­å‹•ç•«æ¨£å¼ (å½±ç‰‡ç‰ˆ) === */
#scene-intro {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background-color: #000;
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
        transition: opacity 1.0s ease-out;
    }

    /* è¨­å®šç‰‡é ­å½±ç‰‡çš„å¤§å° */
    #intro-video {
        width: 100%;
        max-width: 800px;
        height: auto;
        object-fit: contain;
    }

    /* éš±è—ç”¨çš„è¨­å®š */
    .fade-out {
        opacity: 0;
        pointer-events: none;
    }
        /* éš±è—å…ƒç´ çš„é¡åˆ¥ */
        .hidden {
            display: none !important;
        }

        /* 1. åœ°åœ–é é¢å®¹å™¨ */
        #scene-map {
            position: relative;
            width: 100vw;
            height: 100vh;
            background-image: url('map.jpg'); /* ä¸»åœ°åœ–æª”æ¡ˆ */
            background-size: cover;
            background-position: center;
        }

        /* é€æ˜æŒ‰éˆ• (Hotspots) è¨­å®š */
        .hotspot {
            position: absolute;
            /* border: 2px solid red;  æ¸¬è©¦æ™‚å¯ä»¥æŠŠé€™è¡Œæ‰“é–‹ä¾†çœ‹æŒ‰éˆ•åœ¨å“ª */
            cursor: pointer;

            background-color: transparent; /* ç¢ºä¿èƒŒæ™¯å…¨é€æ˜ */
            background-repeat: no-repeat;  /* ä¸è¦é‡è¤‡å¹³é‹ª */
            background-position: center;   /* åœ–ç‰‡ç½®ä¸­ */
            background-size: contain;      /* è®“åœ–ç‰‡ä¿æŒæ¯”ä¾‹ç¸®æ”¾ï¼Œå®Œæ•´é¡¯ç¤ºåœ¨æ¡†æ¡†å…§ */
            
            /* å¢åŠ ä¸€é»é»æ¿¾é¡æ•ˆæœï¼Œè®“æŒ‰éˆ•çœ‹èµ·ä¾†æœ‰å±¤æ¬¡ (é¸ç”¨) */
            filter: drop-shadow(0px 0px 5px rgba(255, 255, 255, 0.5));
            border-radius: 50%; /* åœ“å½¢æ„Ÿæ‡‰å€ */
            background-color: rgba(255, 255, 255, 0); /* å…¨é€æ˜ */
            tap-highlight-color: transparent; /* æ‰‹æ©Ÿé»æ“Šæ™‚ä¸é–ƒçˆ */
        }

     /* === è¨­å®šäº”å€‹å³¶å¶¼çš„æ„Ÿæ‡‰ä½ç½® (é‡å°æ–°åœ°åœ– MAP.jpg èª¿æ•´) === */
        
        /* 1. æƒ¡é¾å±± (å·¦ä¸Š - é»‘è‰²å°–å±±) */
        #btn-dragon { 
            top: 5%; left: 5%; width: 35%; height: 25%; /* ä½ç½®å¯å¾®èª¿ */
            background-image: url('icon_dragon.png');
        }

        /* 2. ç«å±± (å³ä¸Š - å™´ç™¼ç†”å²©) */
        #btn-volcano { 
            top: 18%; right: 5%; width: 35%; height: 25%; 
            background-image: url('icon_volcano.png');
        }

        /* 3. éŠæ¨‚åœ’ (ä¸­å·¦ - å½©è™¹ç€‘å¸ƒå€) */
        /* é€™è£¡å°æ‡‰åŸæœ¬çš„ park å½±ç‰‡ */
        #btn-park { 
            top: 42%; left: 15%; width: 40%; height: 20%; 
            background-image: url('icon_park.png'); 
        }
        
        /* 4. åŸå ¡ (å·¦ä¸‹ - å¸Œè‡˜ç¥æ®¿å»ºç¯‰) */
        /* å› ç‚ºæª”æ¡ˆåŸæœ¬å‘½åç‚º castleï¼Œæ‰€ä»¥æˆ‘å€‘æŠŠ castle æŒ‰éˆ•è¨­åœ¨é€™è£¡ */
        #btn-castle { 
           /* é€™è£¡åŸæœ¬æ˜¯ç¥å»Ÿçš„åº§æ¨™è¨­å®š */
           bottom: 25%; 
            right: 0%; 
            width: 30%; 
            height: 20%; 
            /* åœ–ç‰‡é‚„æ˜¯åŸå ¡ */
            background-image: url('icon_castle.png');
        }
        
        /* 5. ç¥å»Ÿ (å³ä¸‹ - é€£æ¥æ©‹æ¨‘çš„å°å³¶) */
        #btn-temple { 
           /* é€™è£¡åŸæœ¬æ˜¯åŸå ¡çš„åº§æ¨™è¨­å®š */
           bottom: 0%; 
            left: 0%; 
            width: 55%; 
            height: 40%; 
            /* åœ–ç‰‡é‚„æ˜¯ç¥å»Ÿ */
            background-image: url('icon_temple.png');
        }

        /* 2. å½±ç‰‡æ’­æ”¾å®¹å™¨ */
        #scene-video {
            /* â–¼â–¼â–¼ æ–°å¢é€™å››è¡Œï¼Œè®“å®ƒæµ®èµ·ä¾†è“‹ä½åˆ¥äºº â–¼â–¼â–¼ */
            position: absolute; 
            top: 0; 
            left: 0; 
            z-index: 50; /* ç¢ºä¿å®ƒåœ¨æœ€ä¸Šå±¤ */
            /* â–²â–²â–² æ–°å¢çµæŸ â–²â–²â–² */
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            background: #000;
        }
        
        video {
            width: 100%;
            max-height: 100%;
        }

        /* 3. çµæœé é¢å®¹å™¨ */
        #scene-result {
            position: relative;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            display: flex;
            flex-direction: column;
            justify-content: center; /* è®“å…§å®¹åœ¨å‚ç›´æ–¹å‘ç½®ä¸­ï¼Œè€Œä¸æ˜¯é ä¸‹ */
            align-items: center;
            padding-bottom: 0px; /* ç§»é™¤åº•éƒ¨çš„ padding */
            gap: 20px; /* å¢åŠ å…©å€‹æŒ‰éˆ•ä¹‹é–“çš„è·é›¢ */
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        .action-btn {
            background-color: rgba(0, 0, 0, 0.7);
            color: #fff;
            border: 1px solid #fff;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 30px;
            font-size: 18px;
            cursor: pointer;
            width: 80%;
            text-align: center;
            text-decoration: none;
            transition: 0.3s;
        }

        .action-btn:active {
            background-color: #fff;
            color: #000;
        }

        .primary-btn {
            background-color: #e6b800; /* é‡‘è‰²æŒ‰éˆ• */
            color: #000;
            border: none;
            font-weight: bold;
        }
/* === å‘¼å¸å‹•ç•«è¨­å®š === */
@keyframes breathe {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); filter: brightness(1.2); } /* è®Šå¤§ä¸¦è®Šäº® */
            100% { transform: scale(1); }
        }

        /* è®“æ‰€æœ‰æŒ‰éˆ•å¥—ç”¨é€™å€‹å‹•ç•« */
        .hotspot {
            animation: breathe 2s infinite ease-in-out;
        }
        .img-btn-container {
        display: block;
        width: 60%;
        max-width: 300px;
        margin: 10px auto;
        cursor: pointer;
        background: transparent;
        border: none;
        padding: 0;
        text-align: center;
        transition: transform 0.2s;
        text-decoration: none;
    }

    .img-btn-container img {
        width: 100%;
        height: auto;
        display: block;
        filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5)); 
    }

    .img-btn-container:hover {
        transform: scale(1.05);
    }

    .img-btn-container:active {
        transform: scale(0.95);
    }
/* === çµæœé çš„å¾ªç’°èƒŒæ™¯å½±ç‰‡ === */
#result-bg-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* é—œéµï¼šè®“å½±ç‰‡åƒèƒŒæ™¯åœ–ä¸€æ¨£å¡«æ»¿ï¼Œä¸æœƒè®Šå½¢ */
            z-index: 0;        /* æ”¾åœ¨æœ€åº•å±¤ */
        }

        /* ç¢ºä¿æŒ‰éˆ•æµ®åœ¨å½±ç‰‡ä¸Šé¢ (é€™æ®µå¾ˆé‡è¦ï¼Œä¸ç„¶æŒ‰éˆ•æœƒè¢«å½±ç‰‡è“‹ä½æŒ‰ä¸åˆ°) */
        #scene-result .img-btn-container {
            position: relative;
            z-index: 10;       /* æ”¾åœ¨æ¯”å½±ç‰‡é«˜çš„å±¤ç´š */
        }
    /* â–²â–²â–² è²¼åˆ°é€™é‚Šç‚ºæ­¢ â–²â–²â–² */
    </style>
</head>
<body>
    <div id="scene-intro">
        <video id="intro-video" src="intro.mp4" muted autoplay playsinline></video>
    </div>
    <div id="lang-switch" onclick="toggleLanguage()">
        <img id="img-lang" src="lang_to_en.png">
    </div>
    <div id="scene-map">
        <div class="hotspot" id="btn-park" onclick="playScene('park')"></div>
        <div class="hotspot" id="btn-volcano" onclick="playScene('volcano')"></div>
        <div class="hotspot" id="btn-dragon" onclick="playScene('dragon')"></div>
        <div class="hotspot" id="btn-castle" onclick="playScene('castle')"></div>
        <div class="hotspot" id="btn-temple" onclick="playScene('temple')"></div>
    </div>

    <div id="scene-video" class="hidden">
        <video id="video-player" playsinline>
            <source src="" type="video/mp4">
            æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ã€‚
        </video>
    </div>

    <div id="scene-result" class="hidden">
        <video id="result-bg-video" loop muted playsinline></video>
      <div id="btn-start-game" class="img-btn-container" onclick="goToGame()">
            <img id="img-company" src="btn_company.png" alt="é–‹å§‹éŠæˆ²">
        </div>

        <div onclick="resetMap()" class="img-btn-container">
            <img id="img-back" src="btn_back.png" alt="å›åˆ°åœ°åœ–">
        </div>

    </div>
    <audio id="map-bgm" loop>
        <source src="bgm.mp3" type="audio/mp3">
    </audio>
    
    <script>
       // è¨­å®šå€ï¼šè«‹åœ¨é€™è£¡æ›´æ›ä½ çš„å…¬å¸ç¶²å€
       const companyUrl = "https://www.google.com"; 
        // === ğŸï¸ å„å³¶å¶¼çš„å°éŠæˆ²ç¶²å€è¨­å®š (è·¯æ¨™ç³»çµ±) ===
       const gameLinks = {
           // æ ¼å¼ï¼š "å³¶å¶¼ä»£è™Ÿ": "ä½ çš„å°éŠæˆ²ç¶²å€",
           "dragon": "https://www.youtube.com/watch?v=J9nYg8qlu8w", 
           "volcano": "https://videodennischiu-oss.github.io/lava/",
           "park": "https://www.youtube.com/watch?v=dRWoTiAjsOw",
           "castle": "https://videodennischiu-oss.github.io/Castle-Treasure/", 
           "temple": "https://www.youtube.com/watch?v=moqws3j2ykI" 
       };

       // === ğŸš€ è·³è½‰åŠŸèƒ½ ===
       function goToGame() {
           const targetUrl = gameLinks[currentIsland];
           if (targetUrl && targetUrl !== "#") {
               window.location.href = targetUrl; // åŸè¦–çª—è·³è½‰
           } else {
               alert("é€™å€‹å³¶å¶¼çš„éŠæˆ²é‚„åœ¨é–‹ç™¼ä¸­ï¼æ•¬è«‹æœŸå¾…ï¼");
           }
       }

// å–å¾— DOM å…ƒç´ 
const mapScene = document.getElementById('scene-map');
const videoScene = document.getElementById('scene-video');
const resultScene = document.getElementById('scene-result');
const videoPlayer = document.getElementById('video-player');
const companyLink = document.getElementById('link-company');

// è¨­å®šå…¬å¸é€£çµ
if(companyLink) companyLink.href = companyUrl;

// ç”¨ä¾†è¨˜éŒ„ç•¶å‰é¸çš„æ˜¯å“ªå€‹å³¶
let currentIsland = '';

// åŠŸèƒ½ï¼šé–‹å§‹æ’­æ”¾æŸå€‹å³¶å¶¼çš„åŠ‡æƒ… (é›™è»Œæ’­æ”¾ç„¡ç¸«ç‰ˆ)
function playScene(islandName) {
    currentIsland = islandName;
    
    // 1. ç•«é¢è¨­å®šï¼š
    mapScene.classList.add('hidden');       // é—œæ‰åœ°åœ–
    videoScene.classList.remove('hidden'); // æ‰“é–‹éå ´å½±ç‰‡ (å®ƒåœ¨æœ€ä¸Šå±¤)
    resultScene.classList.remove('hidden'); // æ‰“é–‹çµæœå±¤ (è®“å®ƒåœ¨ä¸‹é¢å·å·è·‘)

    // --- A. æ’­æ”¾éå ´å½±ç‰‡ (å‰æ™¯) ---
    const videoPath = `video_${islandName}.mp4`;
    videoPlayer.src = videoPath;
    videoPlayer.load();
    
    // æ­£å¸¸é€Ÿåº¦æ’­æ”¾ (å› ç‚ºä½ å·²ç¶“æŠŠå½±ç‰‡è½‰æˆ 3 å€é€Ÿäº†)
    videoPlayer.play().then(() => {
        // æ’­æ”¾æˆåŠŸ
    }).catch(e => {
        console.log("éå ´å½±ç‰‡æ’­æ”¾å¤±æ•—", e);
        // å¦‚æœå½±ç‰‡å£äº†ï¼Œç›´æ¥é€²çµæœé æ‰ä¸æœƒå¡æ­»
        showResult();
    });

    // --- B. åŒæ™‚æ’­æ”¾èƒŒæ™¯å¾ªç’°å½±ç‰‡ (èƒŒæ™¯) ---
    const bgVideo = document.getElementById('result-bg-video');
    if(bgVideo) {
        bgVideo.src = `loop_${islandName}.mp4`;
        bgVideo.play().catch(e => console.log("èƒŒæ™¯å·è·‘å¤±æ•—", e));
    }
}

// ç›£è½ï¼šç•¶éå ´å½±ç‰‡æ’­æ”¾çµæŸæ™‚
videoPlayer.onended = function() {
    showResult();
};

// åŠŸèƒ½ï¼šé¡¯ç¤ºçµæœåœ– (æ€é–‹è“‹å­ç‰ˆ)
function showResult() {
    // åªè¦æŠŠæœ€ä¸Šå±¤çš„éå ´å½±ç‰‡é—œæ‰ï¼Œåº•ä¸‹çš„å¾ªç’°å½±ç‰‡å°±æœƒéœ²å‡ºä¾†
    videoScene.classList.add('hidden');
}

// åŠŸèƒ½ï¼šå›åˆ°é¦–é åœ°åœ–
function resetMap() {
    resultScene.classList.add('hidden');
    videoScene.classList.add('hidden');
    mapScene.classList.remove('hidden');
    
    // 1. æ¸…ç©ºéå ´åŠ‡æƒ…å½±ç‰‡
    videoPlayer.src = "";
    
    // 2. æ¸…ç©ºèƒŒæ™¯å¾ªç’°å½±ç‰‡ (çœé›»)
    const bgVideo = document.getElementById('result-bg-video');
    if(bgVideo) {
        bgVideo.pause();
        bgVideo.src = ""; // é‡è¦ï¼šæ¸…ç©ºä¾†æºé¿å…é–ƒçˆ
    }
    currentIsland = '';
}

// === ç‰‡é ­å‹•ç•«æ§åˆ¶å€ (æ€¥é€Ÿå•Ÿå‹•ç‰ˆ) ===
document.addEventListener('DOMContentLoaded', function() {
    
    const introScene = document.getElementById('scene-intro');
    const introVideo = document.getElementById('intro-video');
    const enterBtn = document.getElementById('btn-enter'); 
    
    // 1. å˜—è©¦æ’­æ”¾ç‰‡é ­çš„å‡½æ•¸
    function tryPlayIntro() {
        if (introVideo.readyState >= 3) {
            introScene.classList.remove('hidden');
            introVideo.play()
                .then(() => console.log("ç‰‡é ­æ’­æ”¾æˆåŠŸ"))
                .catch(e => {
                    if(enterBtn) enterBtn.classList.remove('hidden');
                });
        } else {
            introVideo.addEventListener('canplay', function() {
                introScene.classList.remove('hidden');
                introVideo.play().catch(e => {
                    if(enterBtn) enterBtn.classList.remove('hidden');
                });
            }, { once: true });
        }
    }

    // åŸ·è¡Œå˜—è©¦
    tryPlayIntro();

    // 2. ç¶å®šã€Œé€²å…¥æŒ‰éˆ•ã€
    if(enterBtn) {
        enterBtn.addEventListener('click', function() {
            enterBtn.classList.add('hidden');
            introVideo.play();
        });
    }
    
    // 3. é—œéµï¼šç›£è½ç‰‡é ­çµæŸï¼Œå¼·åˆ¶é€²å…¥åœ°åœ–
    introVideo.onended = function() {
        console.log("ç‰‡é ­çµæŸï¼Œé€²å…¥åœ°åœ–");
        introScene.classList.add('hidden');
        mapScene.classList.remove('hidden'); 
        
        // å˜—è©¦å•Ÿå‹•éŸ³æ¨‚
        const bgm = document.getElementById('map-bgm');
        if (bgm && bgm.paused) {
            bgm.volume = 0.3;
            bgm.play().catch(e => console.log("ç­‰å¾…äº’å‹•å•Ÿå‹•éŸ³æ¨‚"));
        }
    };
});

// === èªè¨€åˆ‡æ›æ§åˆ¶ (é˜²å‘†ä¿®æ­£ç‰ˆ) ===
let currentLang = 'cn'; 
function toggleLanguage() {
    // 1. å˜—è©¦å–å¾—å…ƒç´  (æ‰¾ä¸åˆ°ä¹Ÿä¸æœƒå ±éŒ¯)
    const titleImg = document.getElementById('img-title');
    const companyImg = document.getElementById('img-company');
    const companyLink = document.getElementById('link-company');
    const langBtnImg = document.getElementById('img-lang'); 
    
    // 2. åˆ‡æ›èªè¨€ç‹€æ…‹
    if (currentLang === 'cn') {
        currentLang = 'en';
        if(titleImg) titleImg.src = 'title_en.png'; 
        if(companyImg) companyImg.src = 'btn_company_en.png'; 
        if(companyLink) companyLink.href = "https://www.google.com/?hl=en";
        if(langBtnImg) langBtnImg.src = 'lang_to_cn.png'; 
    } else {
        currentLang = 'cn';
        if(titleImg) titleImg.src = 'title.png'; 
        if(companyImg) companyImg.src = 'btn_company.png'; 
        if(companyLink) companyLink.href = "https://www.google.com"; 
        if(langBtnImg) langBtnImg.src = 'lang_to_en.png'; 
    }

    // 3. åˆ‡æ›äº”å€‹å³¶å¶¼çš„æŒ‰éˆ•åœ–ç¤º
    const islands = ['dragon', 'volcano', 'park', 'castle', 'temple'];
    islands.forEach(name => {
        const btn = document.getElementById(`btn-${name}`);
        if(btn) {
            if (currentLang === 'en') {
                btn.style.backgroundImage = `url('icon_${name}_en.png')`;
            } else {
                btn.style.backgroundImage = `url('icon_${name}.png')`;
            }
        }
    });
    
    // 4. åˆ‡æ›å›é¦–é æŒ‰éˆ•
    const backImg = document.getElementById('img-back');
    if(backImg) {
        backImg.src = (currentLang === 'en') ? 'btn_back_en.png' : 'btn_back.png';
    }
}

// === éŸ³æ¨‚è§£é– (Safari é›™é‡ä¿éšªç‰ˆ) ===
function unlockAudio() {
    const bgm = document.getElementById('map-bgm');
    if (bgm && bgm.paused) {
        bgm.volume = 0.3; 
        bgm.play().then(() => {
            console.log("èƒŒæ™¯éŸ³æ¨‚å•Ÿå‹•æˆåŠŸ");
            document.removeEventListener('click', unlockAudio);
            document.removeEventListener('touchstart', unlockAudio);
        }).catch(e => {});
    }
}
document.addEventListener('click', unlockAudio);
document.addEventListener('touchstart', unlockAudio);
    </script>
</body>

</html>








